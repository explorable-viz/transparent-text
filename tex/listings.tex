% Listings.
\definecolor{verylightgray}{gray}{0.9}
\definecolor{lightgray}{gray}{0.5}
\definecolor{mediumgray}{gray}{0.45}

\newlength\lsthorizontalpadding
\setlength\lsthorizontalpadding{3pt}
\newcommand*\lstnumberstyle{\ttfamily\scriptsize\textcolor{lightgray}}
% modification of https://tex.stackexchange.com/questions/256629/curly-brace-with-a-bar-next-to-it
\newcommand*{\lbbar}{\{\kern-0.3em|}
\newcommand*{\rbbar}{|\kern-0.3em\}}
\newlength\lstnumbersep
\setlength\lstnumbersep{10pt}
\newlength\lstnumberwidth
\setlength\lstnumberwidth{\widthof{\lstnumberstyle00}+\lstnumbersep+\lsthorizontalpadding}
\lstset{
    ,basicstyle=\linespread{0.9}\ttfamily%
    ,breaklines=true%
    ,escapechar=\~
    ,tabsize=4%
    ,showstringspaces=false%
    ,numbers=left%
    ,numbersep=\lstnumbersep%
    ,numberstyle=\lstnumberstyle%
    ,stringstyle=\color{blue}%
    ,framesep=0pt%
    ,xleftmargin=5pt%\lstnumberwidth%
    ,framexleftmargin=\lsthorizontalpadding%
    ,xrightmargin=\lsthorizontalpadding%
    ,framexrightmargin=\lsthorizontalpadding%
%    ,backgroundcolor=\color{verylightgray}%
    ,postbreak=XXXX\space%
    ,mathescape=true%
}
\lstdefinelanguage{Fluid}{%
   morekeywords={as,else,fun,if,in,let,match,then}%
  ,moredelim=[s][\itshape]{`}{`}
}
\lstnewenvironment{codecol}[1][]{\lstset{language=code,#1,moredelim=*[is][\textcolor{mediumgray}]{|}{|}}}{}
